A05 - Security Misconfiguration - Sample Curl Commands
======================================================

Server: python A05_Example_Security_Misconfiguration.py
Port: 5001

# Test endpoint that exposes debug information:
curl http://localhost:5002/user/1
curl http://localhost:5002/user/999  # Should show detailed error with stack trace

# Test data processing with verbose errors:
curl -X POST http://localhost:5002/process_data -H 'Content-Type: application/json' -d '{"data":"test"}'

# Test with malformed data to trigger detailed errors:
curl -X POST http://localhost:5002/process_data -H 'Content-Type: application/json' -d '{"invalid":"data"}'
curl -X POST http://localhost:5002/process_data -H 'Content-Type: text/plain' -d 'invalid data'

# Test with missing data:
curl -X POST http://localhost:5002/process_data -H 'Content-Type: application/json' -d '{}'

# Vulnerability: Debug mode enabled, verbose error messages, accessible to all hosts
# Impact: Sensitive system information exposed, file paths revealed, stack traces visible

# SECURE ENDPOINTS (Solutions):
# Test secure endpoints with proper error handling:
curl http://localhost:5002/secure/user/1
curl http://localhost:5002/secure/user/999  # Should show generic error message

# Test secure data processing:
curl -X POST http://localhost:5002/secure/process_data \
  -H 'Content-Type: application/json' \
  -d '{"required_field":"test","divisor":2}'

# Test error handling (should not expose stack traces):
curl -X POST http://localhost:5002/secure/process_data \
  -H 'Content-Type: application/json' \
  -d '{"invalid":"data"}'

curl -X POST http://localhost:5002/secure/process_data \
  -H 'Content-Type: application/json' \
  -d '{"required_field":"test","divisor":0}'
