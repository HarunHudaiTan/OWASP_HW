A09 - Security Logging and Monitoring Failures - Sample Curl Commands
=====================================================================

Server: python A09_Example_Logging_Failures.py
Port: 5001

# Test login attempts (insufficient logging):
# Successful login (correct credentials: admin/password):
curl -X POST http://localhost:5002/login -H 'Content-Type: application/json' -d '{"username":"admin","password":"password"}'
# Failed login attempts:
curl -X POST http://localhost:5002/login -H 'Content-Type: application/json' -d '{"username":"admin","password":"wrong"}'
curl -X POST http://localhost:5002/login -H 'Content-Type: application/json' -d '{"username":"hacker","password":"attempt"}'

# Test multiple failed login attempts (should be logged but aren't):
curl -X POST http://localhost:5002/login -H 'Content-Type: application/json' -d '{"username":"admin","password":"admin"}'
curl -X POST http://localhost:5002/login -H 'Content-Type: application/json' -d '{"username":"admin","password":"wrong2"}'
curl -X POST http://localhost:5002/login -H 'Content-Type: application/json' -d '{"username":"admin","password":"wrong3"}'

# Test user deletion (no audit trail):
curl -X DELETE http://localhost:5002/admin/delete_user -H 'Content-Type: application/json' -d '{"user_id":1}'
curl -X DELETE http://localhost:5002/admin/delete_user -H 'Content-Type: application/json' -d '{"user_id":999}'

# Test money transfer (poor logging):
curl -X POST http://localhost:5002/transfer -H 'Content-Type: application/json' -d '{"amount":1000}'
curl -X POST http://localhost:5002/transfer -H 'Content-Type: application/json' -d '{"amount":1000000}'

# Test error endpoint (log injection):
curl http://localhost:5002/error

# Vulnerability: Insufficient logging, no monitoring, no alerting
# Impact: Security incidents go undetected, no audit trail for investigations

# SECURE ENDPOINTS (Solutions):
# Test secure login with comprehensive logging:
curl -X POST http://localhost:5002/secure/login \
  -H 'Content-Type: application/json' \
  -d '{"username":"admin","password":"password"}'

# Test failed login (will be logged with details):
curl -X POST http://localhost:5002/secure/login \
  -H 'Content-Type: application/json' \
  -d '{"username":"admin","password":"wrong"}'

# Test secure admin actions (comprehensive audit logging):
curl -X DELETE http://localhost:5002/secure/admin/delete_user \
  -H 'Content-Type: application/json' \
  -d '{"username":"testuser"}'

# Test secure financial transaction logging:
curl -X POST http://localhost:5002/secure/transfer \
  -H 'Content-Type: application/json' \
  -d '{"amount":1000,"to_account":"12345"}'

# Test secure error handling:
curl http://localhost:5002/secure/error

# View security log summary (admin only):
curl http://localhost:5002/secure/logs/summary
