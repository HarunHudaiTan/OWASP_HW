A01 - Broken Access Control - Sample Curl Commands
=================================================

Server: python A01_Example_Broken_Access_Control.py
Port: 5001

# Test endpoints that should require authentication/authorization:
curl http://localhost:5002/admin/dashboard
curl http://localhost:5002/user/profile
curl http://localhost:5002/account/1/balance
curl http://localhost:5002/account/2/balance
curl http://localhost:5002/account/3/balance

# Test unauthorized actions:
curl -X DELETE http://localhost:5002/api/posts/1
curl -X POST http://localhost:5002/promote
curl http://localhost:5002/verify_token
curl http://localhost:5002/api/sensitive-data

# Test exposed sensitive files:
curl http://localhost:5002/backup/database.sql

# Test login functionality:
curl http://localhost:5002/login

# Vulnerability: All endpoints are accessible without authentication
# Impact: Unauthorized access to admin functions, user data, and sensitive files

# SECURE ENDPOINTS (Solutions):
# First get a token:
curl -X POST http://localhost:5002/secure/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "correct_password"}'

# Use the token for authenticated requests:
curl http://localhost:5002/secure/admin/dashboard \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"

curl http://localhost:5002/secure/user/profile \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"

curl http://localhost:5002/secure/account/1/balance \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
